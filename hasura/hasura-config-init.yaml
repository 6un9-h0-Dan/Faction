apiVersion: v1
kind: ConfigMap
metadata:
  name: hasura-config-init
  namespace: factionc2
  labels:
    app: faction-hasura
data:
  metadata.json: |-
    {
      "version": 2,
      "tables": [
        {
          "table": {
            "schema": "public",
            "name": "agent_checkins"
          },
          "object_relationships": [
            {
              "name": "agent",
              "using": {
                "foreign_key_constraint_on": "agent_id"
              }
            },
            {
              "name": "transport",
              "using": {
                "foreign_key_constraint_on": "transport_id"
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "source_ip",
                  "received",
                  "agent_id",
                  "id",
                  "transport_id"
                ],
                "backend_only": false
              }
            },
            {
              "role": "transport",
              "permission": {
                "check": {},
                "columns": [
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "source_ip",
                  "received",
                  "agent_id",
                  "id",
                  "transport_id"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "agent_id",
                  "transport_id",
                  "source_ip",
                  "iv",
                  "hmac",
                  "message",
                  "received",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "id",
                  "agent_id",
                  "transport_id",
                  "source_ip",
                  "iv",
                  "hmac",
                  "message",
                  "received",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "source_ip",
                  "received",
                  "agent_id",
                  "id",
                  "transport_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "source_ip",
                  "received",
                  "agent_id",
                  "id",
                  "transport_id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "source_ip",
                  "received",
                  "agent_id",
                  "id",
                  "transport_id"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "agent_modules_xref"
          },
          "object_relationships": [
            {
              "name": "agent",
              "using": {
                "foreign_key_constraint_on": "agent_id"
              }
            },
            {
              "name": "module",
              "using": {
                "foreign_key_constraint_on": "module_id"
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "agent_id",
                  "module_id"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "agent_id",
                  "module_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "agent_id",
                  "module_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "agent_id",
                  "module_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "agent_id",
                  "module_id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "agent_id",
                  "module_id"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "agent_task_updates"
          },
          "object_relationships": [
            {
              "name": "agent",
              "using": {
                "foreign_key_constraint_on": "agent_id"
              }
            },
            {
              "name": "agent_task",
              "using": {
                "foreign_key_constraint_on": "task_id"
              }
            }
          ],
          "array_relationships": [
            {
              "name": "iocs",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "agent_task_update_id",
                  "table": {
                    "schema": "public",
                    "name": "iocs"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "id",
                  "agent_id",
                  "task_id",
                  "message",
                  "type",
                  "content",
                  "content_id",
                  "complete",
                  "success",
                  "received",
                  "metadata"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "agent_id",
                  "task_id",
                  "message",
                  "type",
                  "content",
                  "content_id",
                  "complete",
                  "success",
                  "received",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "complete",
                  "success",
                  "metadata",
                  "content",
                  "content_id",
                  "message",
                  "type",
                  "received",
                  "agent_id",
                  "id",
                  "task_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "complete",
                  "success",
                  "metadata",
                  "content",
                  "content_id",
                  "message",
                  "type",
                  "received",
                  "agent_id",
                  "id",
                  "task_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "complete",
                  "success",
                  "metadata",
                  "content",
                  "content_id",
                  "message",
                  "type",
                  "received",
                  "agent_id",
                  "id",
                  "task_id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "complete",
                  "success",
                  "metadata",
                  "content",
                  "content_id",
                  "message",
                  "type",
                  "received",
                  "agent_id",
                  "id",
                  "task_id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": null
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": null
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "agent_tasks"
          },
          "object_relationships": [
            {
              "name": "agent",
              "using": {
                "foreign_key_constraint_on": "agent_id"
              }
            },
            {
              "name": "console_message",
              "using": {
                "foreign_key_constraint_on": "console_message_id"
              }
            }
          ],
          "array_relationships": [
            {
              "name": "agent_task_updates",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "task_id",
                  "table": {
                    "schema": "public",
                    "name": "agent_task_updates"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "id",
                  "agent_id",
                  "console_message_id",
                  "command",
                  "created",
                  "metadata"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "agent_id",
                  "console_message_id",
                  "command",
                  "created",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "command",
                  "created",
                  "agent_id",
                  "console_message_id",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata",
                  "command",
                  "created",
                  "agent_id",
                  "console_message_id",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata",
                  "command",
                  "created",
                  "agent_id",
                  "console_message_id",
                  "id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "command",
                  "created",
                  "agent_id",
                  "console_message_id",
                  "id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": null
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": null
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "agent_types"
          },
          "array_relationships": [
            {
              "name": "agents",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "agent_type_id",
                  "table": {
                    "schema": "public",
                    "name": "agents"
                  }
                }
              }
            },
            {
              "name": "commands",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "agent_type_id",
                  "table": {
                    "schema": "public",
                    "name": "commands"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "id",
                  "name",
                  "authors",
                  "development",
                  "module_types",
                  "metadata"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "name",
                  "authors",
                  "development",
                  "module_types",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "development",
                  "metadata",
                  "authors",
                  "module_types",
                  "name",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "development",
                  "metadata",
                  "authors",
                  "module_types",
                  "name",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "development",
                  "metadata",
                  "authors",
                  "module_types",
                  "name",
                  "id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "development",
                  "metadata",
                  "authors",
                  "module_types",
                  "name",
                  "id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": null
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": null
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "agents"
          },
          "object_relationships": [
            {
              "name": "agent_type",
              "using": {
                "foreign_key_constraint_on": "agent_type_id"
              }
            },
            {
              "name": "payload",
              "using": {
                "foreign_key_constraint_on": "payload_id"
              }
            }
          ],
          "array_relationships": [
            {
              "name": "agent_checkins",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "agent_id",
                  "table": {
                    "schema": "public",
                    "name": "agent_checkins"
                  }
                }
              }
            },
            {
              "name": "agent_modules_xrefs",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "agent_id",
                  "table": {
                    "schema": "public",
                    "name": "agent_modules_xref"
                  }
                }
              }
            },
            {
              "name": "agent_tasks",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "agent_id",
                  "table": {
                    "schema": "public",
                    "name": "agent_tasks"
                  }
                }
              }
            },
            {
              "name": "agent_task_updates",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "agent_id",
                  "table": {
                    "schema": "public",
                    "name": "agent_task_updates"
                  }
                }
              }
            },
            {
              "name": "console_messages",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "agent_id",
                  "table": {
                    "schema": "public",
                    "name": "console_messages"
                  }
                }
              }
            },
            {
              "name": "files",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "agent_id",
                  "table": {
                    "schema": "public",
                    "name": "files"
                  }
                }
              }
            },
            {
              "name": "message_queues",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "agent_id",
                  "table": {
                    "schema": "public",
                    "name": "message_queue"
                  }
                }
              }
            },
            {
              "name": "staging_responses",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "agent_id",
                  "table": {
                    "schema": "public",
                    "name": "staging_responses"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "id",
                  "agent_type_id",
                  "staging_id",
                  "name",
                  "secret_key",
                  "username",
                  "hostname",
                  "pid",
                  "operating_system",
                  "admin",
                  "payload_id",
                  "staging_response_id",
                  "internal_ip",
                  "external_ip",
                  "initial_checkin",
                  "last_checkin",
                  "transport_id",
                  "beacon_interval",
                  "jitter",
                  "visible",
                  "metadata"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "admin",
                  "agent_type_id",
                  "beacon_interval",
                  "external_ip",
                  "hostname",
                  "id",
                  "initial_checkin",
                  "internal_ip",
                  "jitter",
                  "last_checkin",
                  "metadata",
                  "name",
                  "operating_system",
                  "payload_id",
                  "pid",
                  "staging_id",
                  "staging_response_id",
                  "transport_id",
                  "username",
                  "visible"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "admin",
                  "visible",
                  "jitter",
                  "beacon_interval",
                  "pid",
                  "metadata",
                  "external_ip",
                  "hostname",
                  "internal_ip",
                  "name",
                  "operating_system",
                  "secret_key",
                  "username",
                  "initial_checkin",
                  "last_checkin",
                  "agent_type_id",
                  "id",
                  "payload_id",
                  "staging_id",
                  "staging_response_id",
                  "transport_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "admin",
                  "visible",
                  "jitter",
                  "beacon_interval",
                  "pid",
                  "metadata",
                  "external_ip",
                  "hostname",
                  "internal_ip",
                  "name",
                  "operating_system",
                  "secret_key",
                  "username",
                  "initial_checkin",
                  "last_checkin",
                  "agent_type_id",
                  "id",
                  "payload_id",
                  "staging_id",
                  "staging_response_id",
                  "transport_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "admin",
                  "agent_type_id",
                  "beacon_interval",
                  "external_ip",
                  "hostname",
                  "id",
                  "initial_checkin",
                  "internal_ip",
                  "jitter",
                  "last_checkin",
                  "metadata",
                  "name",
                  "operating_system",
                  "payload_id",
                  "pid",
                  "staging_id",
                  "staging_response_id",
                  "transport_id",
                  "username",
                  "visible"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "admin",
                  "visible",
                  "jitter",
                  "beacon_interval",
                  "pid",
                  "metadata",
                  "external_ip",
                  "hostname",
                  "internal_ip",
                  "name",
                  "operating_system",
                  "secret_key",
                  "username",
                  "initial_checkin",
                  "last_checkin",
                  "agent_type_id",
                  "id",
                  "payload_id",
                  "staging_id",
                  "staging_response_id",
                  "transport_id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata",
                  "visible"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata",
                  "visible"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "api_keys"
          },
          "object_relationships": [
            {
              "name": "user",
              "using": {
                "foreign_key_constraint_on": "user_id"
              }
            },
            {
              "name": "user_role",
              "using": {
                "foreign_key_constraint_on": "role_id"
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "id",
                  "user_id",
                  "role_id",
                  "name",
                  "description",
                  "key",
                  "created",
                  "last_used",
                  "enabled",
                  "visible",
                  "metadata"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "user_id",
                  "role_id",
                  "name",
                  "description",
                  "key",
                  "created",
                  "last_used",
                  "enabled",
                  "visible",
                  "metadata"
                ],
                "filter": {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                }
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "key",
                  "metadata",
                  "description",
                  "name",
                  "created",
                  "last_used",
                  "id",
                  "role_id",
                  "user_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "created",
                  "description",
                  "enabled",
                  "id",
                  "key",
                  "last_used",
                  "metadata",
                  "name",
                  "role_id",
                  "user_id",
                  "visible"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "key",
                  "metadata",
                  "description",
                  "name",
                  "created",
                  "last_used",
                  "id",
                  "role_id",
                  "user_id"
                ],
                "filter": {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                }
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "key",
                  "metadata",
                  "description",
                  "name",
                  "created",
                  "last_used",
                  "id",
                  "role_id",
                  "user_id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "enabled",
                  "metadata",
                  "visible"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "enabled",
                  "metadata",
                  "visible"
                ],
                "filter": {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                },
                "check": {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                }
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "command_parameters"
          },
          "object_relationships": [
            {
              "name": "command",
              "using": {
                "foreign_key_constraint_on": "command_id"
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "id",
                  "name",
                  "help",
                  "required",
                  "position",
                  "values",
                  "command_id",
                  "metadata"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "name",
                  "help",
                  "required",
                  "position",
                  "values",
                  "command_id",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "required",
                  "position",
                  "metadata",
                  "help",
                  "name",
                  "values",
                  "command_id",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "required",
                  "position",
                  "metadata",
                  "help",
                  "name",
                  "values",
                  "command_id",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "required",
                  "position",
                  "metadata",
                  "help",
                  "name",
                  "values",
                  "command_id",
                  "id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "required",
                  "position",
                  "metadata",
                  "help",
                  "name",
                  "values",
                  "command_id",
                  "id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": null
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": null
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "commands"
          },
          "object_relationships": [
            {
              "name": "agent_type",
              "using": {
                "foreign_key_constraint_on": "agent_type_id"
              }
            },
            {
              "name": "module",
              "using": {
                "foreign_key_constraint_on": "module_id"
              }
            }
          ],
          "array_relationships": [
            {
              "name": "command_parameters",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "command_id",
                  "table": {
                    "schema": "public",
                    "name": "command_parameters"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "id",
                  "name",
                  "description",
                  "help",
                  "mitre_reference",
                  "opsec_safe",
                  "artifacts",
                  "module_id",
                  "agent_type_id",
                  "metadata"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "name",
                  "description",
                  "help",
                  "mitre_reference",
                  "opsec_safe",
                  "artifacts",
                  "module_id",
                  "agent_type_id",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "opsec_safe",
                  "metadata",
                  "artifacts",
                  "description",
                  "help",
                  "mitre_reference",
                  "name",
                  "agent_type_id",
                  "id",
                  "module_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "opsec_safe",
                  "metadata",
                  "artifacts",
                  "description",
                  "help",
                  "mitre_reference",
                  "name",
                  "agent_type_id",
                  "id",
                  "module_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "opsec_safe",
                  "metadata",
                  "artifacts",
                  "description",
                  "help",
                  "mitre_reference",
                  "name",
                  "agent_type_id",
                  "id",
                  "module_id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "opsec_safe",
                  "metadata",
                  "artifacts",
                  "description",
                  "help",
                  "mitre_reference",
                  "name",
                  "agent_type_id",
                  "id",
                  "module_id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": null
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "console_messages"
          },
          "object_relationships": [
            {
              "name": "agent",
              "using": {
                "foreign_key_constraint_on": "agent_id"
              }
            },
            {
              "name": "user",
              "using": {
                "foreign_key_constraint_on": "user_id"
              }
            }
          ],
          "array_relationships": [
            {
              "name": "agent_tasks",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "console_message_id",
                  "table": {
                    "schema": "public",
                    "name": "agent_tasks"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "id",
                  "agent_id",
                  "user_id",
                  "agent_task_id",
                  "type",
                  "content",
                  "received",
                  "metadata"
                ],
                "backend_only": false
              }
            },
            {
              "role": "super-user",
              "permission": {
                "check": {},
                "columns": [
                  "metadata",
                  "content",
                  "type",
                  "received",
                  "agent_id",
                  "agent_task_id",
                  "id",
                  "user_id"
                ],
                "backend_only": false
              }
            },
            {
              "role": "user",
              "permission": {
                "check": {},
                "columns": [
                  "metadata",
                  "content",
                  "type",
                  "received",
                  "agent_id",
                  "agent_task_id",
                  "id",
                  "user_id"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "agent_id",
                  "user_id",
                  "agent_task_id",
                  "type",
                  "content",
                  "received",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "content",
                  "type",
                  "received",
                  "agent_id",
                  "agent_task_id",
                  "id",
                  "user_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata",
                  "content",
                  "type",
                  "received",
                  "agent_id",
                  "agent_task_id",
                  "id",
                  "user_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata",
                  "content",
                  "type",
                  "received",
                  "agent_id",
                  "agent_task_id",
                  "id",
                  "user_id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "content",
                  "type",
                  "received",
                  "agent_id",
                  "agent_task_id",
                  "id",
                  "user_id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "error_messages"
          },
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "id",
                  "source",
                  "message",
                  "details",
                  "timestamp",
                  "metadata"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "source",
                  "message",
                  "details",
                  "timestamp",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "details",
                  "message",
                  "source",
                  "timestamp",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata",
                  "details",
                  "message",
                  "source",
                  "timestamp",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata",
                  "details",
                  "message",
                  "source",
                  "timestamp",
                  "id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "details",
                  "message",
                  "source",
                  "timestamp",
                  "id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "files"
          },
          "object_relationships": [
            {
              "name": "agent",
              "using": {
                "foreign_key_constraint_on": "agent_id"
              }
            },
            {
              "name": "user",
              "using": {
                "foreign_key_constraint_on": "user_id"
              }
            }
          ],
          "array_relationships": [
            {
              "name": "payloads",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "file_id",
                  "table": {
                    "schema": "public",
                    "name": "payloads"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "id",
                  "description",
                  "type",
                  "hash",
                  "file_path",
                  "agent_id",
                  "source_file_path",
                  "user_id",
                  "created",
                  "last_downloaded",
                  "visible",
                  "public_key",
                  "url",
                  "metadata"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "description",
                  "type",
                  "hash",
                  "file_path",
                  "agent_id",
                  "source_file_path",
                  "user_id",
                  "created",
                  "last_downloaded",
                  "visible",
                  "public_key",
                  "url",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "visible",
                  "metadata",
                  "description",
                  "file_path",
                  "hash",
                  "public_key",
                  "source_file_path",
                  "type",
                  "url",
                  "created",
                  "last_downloaded",
                  "agent_id",
                  "id",
                  "user_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "visible",
                  "metadata",
                  "description",
                  "file_path",
                  "hash",
                  "public_key",
                  "source_file_path",
                  "type",
                  "url",
                  "created",
                  "last_downloaded",
                  "agent_id",
                  "id",
                  "user_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "visible",
                  "metadata",
                  "description",
                  "file_path",
                  "hash",
                  "public_key",
                  "source_file_path",
                  "type",
                  "url",
                  "created",
                  "last_downloaded",
                  "agent_id",
                  "id",
                  "user_id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "visible",
                  "metadata",
                  "description",
                  "file_path",
                  "hash",
                  "public_key",
                  "source_file_path",
                  "type",
                  "url",
                  "created",
                  "last_downloaded",
                  "agent_id",
                  "id",
                  "user_id"
                ],
                "filter": {},
                "check": null
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata",
                  "visible"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata",
                  "visible"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "iocs"
          },
          "object_relationships": [
            {
              "name": "agent_task_update",
              "using": {
                "foreign_key_constraint_on": "agent_task_update_id"
              }
            },
            {
              "name": "user",
              "using": {
                "foreign_key_constraint_on": "user_id"
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "id",
                  "description",
                  "type",
                  "identifier",
                  "hash",
                  "action",
                  "agent_task_update_id",
                  "user_id",
                  "timestamp",
                  "metadata"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "description",
                  "type",
                  "identifier",
                  "hash",
                  "action",
                  "agent_task_update_id",
                  "user_id",
                  "timestamp",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "id",
                  "description",
                  "type",
                  "identifier",
                  "hash",
                  "action",
                  "agent_task_update_id",
                  "user_id",
                  "timestamp",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata",
                  "action",
                  "description",
                  "hash",
                  "identifier",
                  "type",
                  "timestamp",
                  "agent_task_update_id",
                  "id",
                  "user_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata",
                  "action",
                  "description",
                  "hash",
                  "identifier",
                  "type",
                  "timestamp",
                  "agent_task_update_id",
                  "id",
                  "user_id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "action",
                  "description",
                  "hash",
                  "identifier",
                  "type",
                  "timestamp",
                  "agent_task_update_id",
                  "id",
                  "user_id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "message_queue"
          },
          "object_relationships": [
            {
              "name": "agent",
              "using": {
                "foreign_key_constraint_on": "agent_id"
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "sent",
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "route_info",
                  "created",
                  "agent_id",
                  "agent_task_id",
                  "id"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "agent_id",
                  "agent_task_id",
                  "route_info",
                  "iv",
                  "hmac",
                  "message",
                  "sent",
                  "created",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "sent",
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "route_info",
                  "created",
                  "agent_id",
                  "agent_task_id",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "sent",
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "route_info",
                  "created",
                  "agent_id",
                  "agent_task_id",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "sent",
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "route_info",
                  "created",
                  "agent_id",
                  "agent_task_id",
                  "id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "sent",
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "route_info",
                  "created",
                  "agent_id",
                  "agent_task_id",
                  "id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "modules"
          },
          "array_relationships": [
            {
              "name": "agent_modules_xrefs",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "module_id",
                  "table": {
                    "schema": "public",
                    "name": "agent_modules_xref"
                  }
                }
              }
            },
            {
              "name": "commands",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "module_id",
                  "table": {
                    "schema": "public",
                    "name": "commands"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "metadata",
                  "authors",
                  "description",
                  "module_type",
                  "name",
                  "id"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "name",
                  "description",
                  "authors",
                  "module_type",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "authors",
                  "description",
                  "module_type",
                  "name",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata",
                  "authors",
                  "description",
                  "module_type",
                  "name",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata",
                  "authors",
                  "description",
                  "module_type",
                  "name",
                  "id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "authors",
                  "description",
                  "module_type",
                  "name",
                  "id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "payload_type"
          },
          "array_relationships": [
            {
              "name": "payloads",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "payload_type_id",
                  "table": {
                    "schema": "public",
                    "name": "payloads"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "configuration_schema",
                  "metadata",
                  "description",
                  "name",
                  "agent_type_id",
                  "id",
                  "transport_guid"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "name",
                  "description",
                  "agent_type_id",
                  "transport_guid",
                  "metadata",
                  "configuration_schema"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "configuration_schema",
                  "metadata",
                  "description",
                  "name",
                  "agent_type_id",
                  "id",
                  "transport_guid"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "configuration_schema",
                  "metadata",
                  "description",
                  "name",
                  "agent_type_id",
                  "id",
                  "transport_guid"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "configuration_schema",
                  "metadata",
                  "description",
                  "name",
                  "agent_type_id",
                  "id",
                  "transport_guid"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "configuration_schema",
                  "metadata",
                  "description",
                  "name",
                  "agent_type_id",
                  "id",
                  "transport_guid"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "payloads"
          },
          "object_relationships": [
            {
              "name": "file",
              "using": {
                "foreign_key_constraint_on": "file_id"
              }
            },
            {
              "name": "payload_type",
              "using": {
                "foreign_key_constraint_on": "payload_type_id"
              }
            },
            {
              "name": "transport",
              "using": {
                "foreign_key_constraint_on": "transport_id"
              }
            },
            {
              "name": "user",
              "using": {
                "foreign_key_constraint_on": "created_by"
              }
            }
          ],
          "array_relationships": [
            {
              "name": "agents",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "payload_id",
                  "table": {
                    "schema": "public",
                    "name": "agents"
                  }
                }
              }
            },
            {
              "name": "staging_messages",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "payload_id",
                  "table": {
                    "schema": "public",
                    "name": "staging_messages"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "description",
                  "name",
                  "staging_key",
                  "created",
                  "expiration_date",
                  "last_downloaded",
                  "created_by",
                  "file_id",
                  "id",
                  "payload_type_id",
                  "transport_id"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "payload_type_id",
                  "transport_id",
                  "file_id",
                  "name",
                  "description",
                  "staging_key",
                  "last_downloaded",
                  "expiration_date",
                  "configuration",
                  "created",
                  "visible",
                  "enabled",
                  "created_by",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "description",
                  "name",
                  "staging_key",
                  "created",
                  "expiration_date",
                  "last_downloaded",
                  "created_by",
                  "file_id",
                  "id",
                  "payload_type_id",
                  "transport_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "description",
                  "name",
                  "staging_key",
                  "created",
                  "expiration_date",
                  "last_downloaded",
                  "created_by",
                  "file_id",
                  "id",
                  "payload_type_id",
                  "transport_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "description",
                  "name",
                  "staging_key",
                  "created",
                  "expiration_date",
                  "last_downloaded",
                  "created_by",
                  "file_id",
                  "id",
                  "payload_type_id",
                  "transport_id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "description",
                  "name",
                  "staging_key",
                  "created",
                  "expiration_date",
                  "last_downloaded",
                  "created_by",
                  "file_id",
                  "id",
                  "payload_type_id",
                  "transport_id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "description",
                  "enabled",
                  "metadata",
                  "name",
                  "visible"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "description",
                  "enabled",
                  "metadata",
                  "name"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "staging_messages"
          },
          "object_relationships": [
            {
              "name": "payload",
              "using": {
                "foreign_key_constraint_on": "payload_id"
              }
            },
            {
              "name": "staging_response",
              "using": {
                "foreign_key_constraint_on": "staging_response_id"
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "source_ip",
                  "staging_id",
                  "received",
                  "id",
                  "payload_id",
                  "staging_response_id",
                  "transport_id"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "payload_id",
                  "source_ip",
                  "transport_id",
                  "staging_id",
                  "staging_response_id",
                  "iv",
                  "hmac",
                  "message",
                  "received",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "source_ip",
                  "staging_id",
                  "received",
                  "id",
                  "payload_id",
                  "staging_response_id",
                  "transport_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "source_ip",
                  "staging_id",
                  "received",
                  "id",
                  "payload_id",
                  "staging_response_id",
                  "transport_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "source_ip",
                  "staging_id",
                  "received",
                  "id",
                  "payload_id",
                  "staging_response_id",
                  "transport_id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "source_ip",
                  "staging_id",
                  "received",
                  "id",
                  "payload_id",
                  "staging_response_id",
                  "transport_id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "staging_responses"
          },
          "object_relationships": [
            {
              "name": "agent",
              "using": {
                "foreign_key_constraint_on": "agent_id"
              }
            }
          ],
          "array_relationships": [
            {
              "name": "staging_messages",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "staging_response_id",
                  "table": {
                    "schema": "public",
                    "name": "staging_messages"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "sent",
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "created",
                  "agent_id",
                  "id",
                  "staging_message_id"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "agent_id",
                  "staging_message_id",
                  "iv",
                  "hmac",
                  "message",
                  "created",
                  "sent",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "sent",
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "created",
                  "agent_id",
                  "id",
                  "staging_message_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "sent",
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "created",
                  "agent_id",
                  "id",
                  "staging_message_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "sent",
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "created",
                  "agent_id",
                  "id",
                  "staging_message_id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "sent",
                  "metadata",
                  "hmac",
                  "iv",
                  "message",
                  "created",
                  "agent_id",
                  "id",
                  "staging_message_id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "message"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "transports"
          },
          "array_relationships": [
            {
              "name": "agent_checkins",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "transport_id",
                  "table": {
                    "schema": "public",
                    "name": "agent_checkins"
                  }
                }
              }
            },
            {
              "name": "payloads",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "transport_id",
                  "table": {
                    "schema": "public",
                    "name": "payloads"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "name",
                  "protocol",
                  "created",
                  "id",
                  "transport_guid"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "transport_guid",
                  "name",
                  "protocol",
                  "configuration",
                  "created",
                  "enabled",
                  "visible",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "name",
                  "protocol",
                  "created",
                  "id",
                  "transport_guid"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "name",
                  "protocol",
                  "created",
                  "id",
                  "transport_guid"
                ],
                "filter": {}
              }
            },
            {
              "role": "transport",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "name",
                  "protocol",
                  "created",
                  "id",
                  "transport_guid"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "name",
                  "protocol",
                  "created",
                  "id",
                  "transport_guid"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "name",
                  "protocol",
                  "created",
                  "id",
                  "transport_guid"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "enabled",
                  "metadata",
                  "name",
                  "visible"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "transport",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "configuration",
                  "metadata",
                  "name",
                  "protocol",
                  "created",
                  "id",
                  "transport_guid"
                ],
                "filter": {
                  "id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                },
                "check": null
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "configuration",
                  "metadata",
                  "name"
                ],
                "filter": {},
                "check": null
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "user_roles"
          },
          "array_relationships": [
            {
              "name": "api_keys",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "role_id",
                  "table": {
                    "schema": "public",
                    "name": "api_keys"
                  }
                }
              }
            },
            {
              "name": "users",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "role_id",
                  "table": {
                    "schema": "public",
                    "name": "users"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "metadata",
                  "name",
                  "id"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "id",
                  "name",
                  "metadata"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "name",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata",
                  "name",
                  "id"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "metadata",
                  "name",
                  "id"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "metadata",
                  "name",
                  "id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "metadata"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        },
        {
          "table": {
            "schema": "public",
            "name": "users"
          },
          "object_relationships": [
            {
              "name": "user_role",
              "using": {
                "foreign_key_constraint_on": "role_id"
              }
            }
          ],
          "array_relationships": [
            {
              "name": "api_keys",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "user_id",
                  "table": {
                    "schema": "public",
                    "name": "api_keys"
                  }
                }
              }
            },
            {
              "name": "console_messages",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "user_id",
                  "table": {
                    "schema": "public",
                    "name": "console_messages"
                  }
                }
              }
            },
            {
              "name": "files",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "user_id",
                  "table": {
                    "schema": "public",
                    "name": "files"
                  }
                }
              }
            },
            {
              "name": "iocs",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "user_id",
                  "table": {
                    "schema": "public",
                    "name": "iocs"
                  }
                }
              }
            },
            {
              "name": "payloads",
              "using": {
                "foreign_key_constraint_on": {
                  "column": "created_by",
                  "table": {
                    "schema": "public",
                    "name": "payloads"
                  }
                }
              }
            }
          ],
          "insert_permissions": [
            {
              "role": "service",
              "permission": {
                "check": {},
                "columns": [
                  "enabled",
                  "visible",
                  "password",
                  "metadata",
                  "username",
                  "created",
                  "last_login",
                  "id",
                  "role_id"
                ],
                "backend_only": false
              }
            }
          ],
          "select_permissions": [
            {
              "role": "read-only",
              "permission": {
                "columns": [
                  "created",
                  "enabled",
                  "id",
                  "last_login",
                  "metadata",
                  "role_id",
                  "username",
                  "visible"
                ],
                "filter": {}
              }
            },
            {
              "role": "service",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "password",
                  "metadata",
                  "username",
                  "created",
                  "last_login",
                  "id",
                  "role_id"
                ],
                "filter": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "created",
                  "enabled",
                  "id",
                  "last_login",
                  "metadata",
                  "role_id",
                  "username",
                  "visible"
                ],
                "filter": {}
              }
            },
            {
              "role": "user",
              "permission": {
                "columns": [
                  "created",
                  "enabled",
                  "id",
                  "last_login",
                  "metadata",
                  "role_id",
                  "username",
                  "visible"
                ],
                "filter": {}
              }
            }
          ],
          "update_permissions": [
            {
              "role": "service",
              "permission": {
                "columns": [
                  "enabled",
                  "visible",
                  "password",
                  "metadata",
                  "username",
                  "created",
                  "last_login",
                  "id",
                  "role_id"
                ],
                "filter": {},
                "check": {}
              }
            },
            {
              "role": "super-user",
              "permission": {
                "columns": [
                  "enabled",
                  "metadata",
                  "username",
                  "visible"
                ],
                "filter": {},
                "check": {}
              }
            }
          ]
        }
      ]
    }
